{"version":3,"sources":["webpack:///webpack/bootstrap 78d619afe6644960c4b0","webpack:///./src/main.js","webpack:///./app.js","webpack:///./src/directives.js","webpack:///./src/filters.js"],"names":["prefix","selector","Object","keys","map","d","join","Seed","opts","self","root","el","document","getElementById","id","els","querySelectorAll","bindings","scope","forEach","call","processNode","key","cloneAttributes","attributes","directive","parseDirective","attr","bindDirective","name","value","seed","removeAttribute","binding","undefined","directives","push","bind","hasOwnProperty","bindAccessors","defineProperty","get","set","vaue","filters","applyFilters","update","argument","indexOf","noprefix","slice","length","argIndex","dirname","def","arg","exp","pipeIndex","trim","split","filter","definition","customFilter","create","app","msg","hello","changeMessage","text","textContent","show","style","display","class","classname","classList","on","handler","event","handlers","removeEventListener","addEventListener","unbind","selectors","e","match","every","target","webkitMatchesSelector","apply","arguments","capitalize","toString","charAt","toUpperCase"],"mappings":"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","file":"bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId])\n \t\t\treturn installedModules[moduleId].exports;\n\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 1);\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 78d619afe6644960c4b0","var prefix = 'sd'\n\nimport Directives from './directives.js'\nimport Filters from './filters.js'\n// debugger;\nvar selector = Object.keys(Directives).map( d => {\n  return `[${prefix}-${d}]`\n}).join()\n\nfunction Seed(opts) {\n  var self = this,\n      root = this.el = document.getElementById(opts.id), //root el\n      els = root.querySelectorAll(selector), // 获得带有vue指令的节点组成的数组\n      bindings = {}  //internal real data\n\n      self.scope = {} // external interface\n\n      // 处理带有指令的节点\n      ;[].forEach.call(els, processNode)\n      processNode(root)\n\n      for (var key in bindings) {\n        self.scope[key] = opts.scope[key]\n      }\n\n      function processNode(el) {\n        cloneAttributes(el.attributes).forEach( attr => {\n          let directive = parseDirective(attr)\n          if (directive) {\n            bindDirective(self, el, bindings, directive)\n          }\n        })\n      }\n}\n\n// 返回指令的属性 name 和 value\nfunction cloneAttributes(attributes) {\n  return [].map.call(attributes, attr => {\n    return {\n      name: attr.name,\n      value: attr.value\n    }\n  })\n}\n// seed, el, bindings 是之前就存在的参数\n// directive是刚刚准备好的参数\nfunction bindDirective(seed, el, bindings, directive) {\n  el.removeAttribute(directive.attr.name)\n  var key = directive.key,\n  binding = bindings[key]\n  if (!binding) {\n    bindings[key] = binding = {\n      value: undefined,\n      directives: []\n    }\n  }\n  directive.el = el\n  binding.directives.push(directive)\n\n  if (directive.bind) {\n    directive.bind(el, binding.value)\n  } // ?\n\n  if (!seed.scope.hasOwnProperty(key)) {\n    bindAccessors(seed, key, binding)\n  }\n}\n\nfunction bindAccessors(seed, key, binding) {\n  Object.defineProperty(seed.scope, key, {\n    get () {\n      return binding.value\n    },\n    set (value) {\n      binding.vaue = value\n      binding.directives.forEach( directive => {\n        if (value && directive.filters) {\n          // 如果带有过滤器，则执行过滤器方法\n          value = applyFilters(value, directive)\n        }\n        directive.update(\n          directive.el,\n          value,\n          directive.argument,\n          directive,\n          seed\n        ) // text() or update()\n      })\n    }\n  })\n}\n\n// 对不同形式的指令 进行分解和处理 ,带“-”的 带“|”的\nfunction parseDirective(attr) {\n  if (attr.name.indexOf(prefix) === -1) return\n\n  // 处理属性名 sd-text or sd-on-update\n  let noprefix = attr.name.slice(prefix.length + 1), //text or on-update\n      argIndex = noprefix.indexOf('-'),\n      dirname = argIndex === -1 ? noprefix : noprefix.slice(0, argIndex), // text or on\n      def = Directives[dirname], // text() or on {}\n      arg = argIndex === -1 ? null : noprefix.slice(argIndex + 1) // update\n\n //处理属性值\n\n let exp = attr.value,\n     pipeIndex = exp.indexOf('|'),\n     key = pipeIndex === -1 ? exp.trim() : exp.slice(0, pipeIndex).trim(),\n     filters = pipeIndex === -1 ? null : exp.slice(pipeIndex + 1).split('|').map(\n       filter => { return filter.trim() }\n     )\n\n return def\n ? {\n   attr: attr, // name, value\n   key: key, // value\n   filters: filters, // filter-name\n   definition: def, // 指令对应的方法\n   argument: arg, // null or update\n   update: typeof def === 'function' ? def : def.update //text() or on.update()\n }\n : null\n}\n\n\n\nfunction applyFilters(value, directive) {\n  if (directive.definition.customFilter) {\n    //  监听事件触发\n    return directive.definition.customFilter(value, directive.filters)\n  } else {\n\n    directive.filters.forEach( filter => {\n      if (Filters[filter]) {\n        value = Filters[filter](value)\n      }\n    })\n    return value\n  }\n}\nexport default {\n  create (opts) {\n    return new Seed(opts)\n  },\n  filters: Filters,\n  directives: Directives\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/main.js","import Seed from './src/main.js'\n (function(){\n   var app = Seed.create({\n       id: 'test',\n       // template\n       scope: {\n           msg: 'hello',\n           hello: 'WHWHWHW',\n           changeMessage: function () {\n               app.scope.msg = 'hola'\n           }\n       }\n   })\n })()\n\n\n\n// WEBPACK FOOTER //\n// ./app.js","export default {\n    text: function (el, value) {\n        el.textContent = value || ''\n    },\n    show: function (el, value) {\n        el.style.display = value ? '' : 'none'\n    },\n    class: function (el, value, classname) {\n        el.classList[value ? 'add' : 'remove'](classname)\n    },\n    on: {\n        update: function (el, handler, event, directive) {\n            if (!directive.handlers) {\n                directive.handlers = {}\n            }\n            var handlers = directive.handlers\n            if (handlers[event]) {\n                el.removeEventListener(event, handlers[event])\n            }\n            if (handler) {\n                handler = handler.bind(el)\n                el.addEventListener(event, handler)\n                handlers[event] = handler\n            }\n        },\n        unbind: function (el, event, directive) {\n            if (directive.handlers) {\n                el.removeEventListener(event, directive.handlers[event])\n            }\n        },\n        customFilter: function (handler, selectors) {\n            return function (e) {\n                var match = selectors.every(function (selector) {\n                    return e.target.webkitMatchesSelector(selector) //匹配一个字符串，匹配成功返回true\n                })\n                if (match) handler.apply(this, arguments)\n            }\n        }\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/directives.js","export default  {\n    capitalize: function (value) {\n        value = value.toString()\n        return value.charAt(0).toUpperCase() + value.slice(1)\n    }\n}\n\n\n\n// WEBPACK FOOTER //\n// ./src/filters.js"],"sourceRoot":""}